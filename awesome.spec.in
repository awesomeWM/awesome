Name:		@CPACK_PACKAGE_NAME@
Version:	@version_num@
Release:	1.@GIT_RELEASE_STRING@%{?dist}
Summary:	Highly configurable, framework window manager for X. Fast, light and extensible
Group:		User Interface/Desktops
# common/buffer.[ch]: BSD
License:	GPLv2+ and BSD
URL:		http://awesomewm.org

# Core make requirements
BuildRequires:	cmake >= 3.0.0
BuildRequires:	lua-devel >= 5.1

# Convert utility
BuildRequires:	ImageMagick

# Generate manpages
BuildRequires:	asciidoc
BuildRequires:	xmlto
BuildRequires:	gzip

# Generate documentation
BuildRequires:	lua-ldoc

#awesomeConfig.cmake libraries list
# Required
BuildRequires:	pkgconfig(xcb) >= 1.6
# Dependencies
BuildRequires:	pkgconfig(glib-2.0)
BuildRequires:	pkgconfig(gdk-pixbuf-2.0)
BuildRequires:	pkgconfig(cairo)
BuildRequires:	pkgconfig(x11)
BuildRequires:	pkgconfig(xcb-cursor)
BuildRequires:	pkgconfig(xcb-randr)
BuildRequires:	pkgconfig(xcb-xtest)
BuildRequires:	pkgconfig(xcb-xinerama)
BuildRequires:	pkgconfig(xcb-shape)
BuildRequires:	pkgconfig(xcb-util) >= 0.3.8
BuildRequires:	pkgconfig(xcb-keysyms) >= 0.3.4
BuildRequires:	pkgconfig(xcb-icccm) >= 0.3.8
BuildRequires:	pkgconfig(xcb-xkb)
BuildRequires:	pkgconfig(xkbcommon)
BuildRequires:	pkgconfig(xkbcommon-x11)
BuildRequires:	pkgconfig(cairo-xcb)
BuildRequires:	pkgconfig(libstartup-notification-1.0) >= 0.10
BuildRequires:	pkgconfig(xproto) >= 7.0.15
BuildRequires:	pkgconfig(libxdg-basedir) >= 1.0.0
BuildRequires:	pkgconfig(xcb-xrm) >= 1.0
# Optional (WITH_DBUS on by default though)
BuildRequires:	pkgconfig(dbus-1)

# Required in lua files
BuildRequires:	lua-lgi >= 0.7.1
BuildRequires:	pkgconfig(pango) >= 1.19.3
BuildRequires:	pkgconfig(pangocairo) >= 1.19.3
# Required for running tests
BuildRequires:	pkgconfig(cairo-gobject)

# Only for desktop-file-validate in install section
BuildRequires:	desktop-file-utils

# Required runtime
Requires:	lua-lgi >= 0.7.1
# next two loaded via lgi
Requires:	pango%{?_isa} >= 1.19.3
Requires:	cairo-gobject%{?_isa}

Requires:	startup-notification >= 0.10
# terminal used in the default configuration
Requires:	xterm
# editor used in the default configuration
Requires:	nano


%description
Awesome is a highly configurable, next generation framework window
manager for X. It is very fast, light and extensible.

It is primary targeted at power users, developers and any people
dealing with every day computing tasks and want to have fine-grained
control on its graphical environment.


%package	doc
Summary:	API doc files
Group:		Documentation
BuildArch:	noarch
Requires:	%{name} = %{version}-%{release}

%description	doc
API doc files for awesome generated by luadoc.


%prep


%build
mkdir build
pushd build
%cmake -DAWESOME_DOC_PATH=%{_pkgdocdir} \
       -DSYSCONFDIR=%{_sysconfdir} \
	@CMAKE_SOURCE_DIR@
popd
make -C build VERBOSE=1 %{?_smp_mflags} awesome


%install
make -C build DESTDIR="%{buildroot}" INSTALL="install -p" install

# verify desktop file
desktop-file-validate %{buildroot}%{_datadir}/xsessions/%{name}.desktop


%files
%dir %{_pkgdocdir}
%doc %{_pkgdocdir}/*
%license %{_pkgdocdir}/LICENSE
%exclude %{_pkgdocdir}/doc
%dir %{_sysconfdir}/xdg/%{name}
%config(noreplace) %{_sysconfdir}/xdg/%{name}/rc.lua
%{_bindir}/awesome
%{_bindir}/awesome-client
%{_datadir}/%{name}
%{_mandir}/man?/*
%{_mandir}/*/man1/*
%{_mandir}/*/man5/*
%{_datadir}/xsessions/%{name}.desktop


%files doc
%dir %{_pkgdocdir}
%doc %{_pkgdocdir}/doc


